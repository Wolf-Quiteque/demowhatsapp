(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[414],{5117:function(e,a,s){"use strict";function n(){for(var e="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%^&*",s=0;s<8;s++)e+=a.charAt(Math.floor(Math.random()*a.length));return e}s.d(a,{Z:function(){return n}})},5922:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return h}});var n=s(29),t=s(7794),r=s.n(t),i=s(9008),l=s(7294),o=s(782),c=s(1163),d=s(6304),u=(s(4213),s(5117)),m=s(5893);function h(){var e,a=(0,l.useState)(),s=a[0],t=a[1],h=(0,l.useState)(),p=h[0],x=h[1],f=(0,l.useState)(1),j=f[0],N=f[1],b=(0,l.useState)(),g=b[0],v=b[1],y=(0,l.useState)(),C=y[0],k=y[1],w=(0,l.useState)(!1),S=w[0],O=w[1],A=(0,l.useState)(),E=A[0],_=A[1],T=(0,l.useState)(),L=T[0],P=T[1],Z=(0,l.useState)(),M=Z[0],J=Z[1],U=(0,l.useState)({}),G=U[0],X=(U[1],(0,l.useState)()),q=X[0],I=X[1],Q=[],R=(0,c.useRouter)(),z=function(){var e=(0,n.Z)(r().mark((function e(){var a,s,n,i,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=G).tipo="administrador",e.next=4,fetch("/api/usuarios/allusers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:j,info:a})});case 4:return s=e.sent,e.next=7,s.json();case 7:for(n=e.sent,t(n.usuarios),k(n.pages),i=0;i<n.pages;i++)l=Number(i)+1,Q.push({page:l});v(Q);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,n.Z)(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.QN)("authsesh");case 2:(a=e.sent)&&"administrador"==a.tipo?x(a):R.replace("/");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){t(null),z()}),[j,G,q]),(0,l.useEffect)((function(){p||B()}),[]);var D=function(){var a=(0,n.Z)(r().mark((function a(){var s,n,t;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=o.Am.loading("aguarde...",{closeOnClick:!0}),a.next=4,fetch("/api/usuarios/eliminate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:p._id})});case 4:return s=a.sent,a.next=7,s.json();case 7:n=a.sent,z(),o.Am.update(e,{render:n.message,type:"success",isLoading:!1,closeOnClick:!0,autoClose:1300}),a.next=18;break;case 12:return a.prev=12,a.t0=a.catch(0),a.next=16,res.json();case 16:t=a.sent,o.Am.update(e,{render:t.message,type:"error",isLoading:!1,closeOnClick:!0,autoClose:1300});case 18:O(!1),$("#eliminar").modal("hide");case 20:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(){return a.apply(this,arguments)}}(),F=function(){var a=(0,n.Z)(r().mark((function a(){var s,n,t;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=o.Am.loading("aguarde...",{closeOnClick:!0}),O(!0),a.prev=2,a.next=5,fetch("/api/usuarios/novo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:M.toLowerCase(),cargo:L,nome:E,tipo:"administrador"})});case 5:return s=a.sent,a.next=8,s.json();case 8:n=a.sent,z(),O(!1),o.Am.update(e,{render:n.message,type:"success",isLoading:!1,closeOnClick:!0,autoClose:1300}),a.next=19;break;case 14:a.prev=14,a.t0=a.catch(2),o.Am.update(e,{render:a.t0,type:"error",isLoading:!1,closeOnClick:!0,autoClose:1300}),O(!1),$("#novo").modal("hide");case 19:return a.next=21,res.json();case 21:t=a.sent,o.Am.update(e,{render:t.message,type:"success",isLoading:!1,closeOnClick:!0,autoClose:1300}),I((0,u.Z)()),O(!1);case 25:case"end":return a.stop()}}),a,null,[[2,14]])})));return function(){return a.apply(this,arguments)}}();return(0,m.jsxs)("div",{className:"container",children:[(0,m.jsxs)(i.default,{children:[(0,m.jsx)("title",{children:"ANJE - Gest\xe3o do Usu\xe1rio"}),(0,m.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,m.jsxs)("main",{children:[(0,m.jsx)(o.Ix,{}),(0,m.jsxs)("div",{className:"row",children:[(0,m.jsxs)("div",{className:"col-md-12",children:[(0,m.jsx)("h3",{className:"mt-3 mb-3",children:"Gest\xe3o de Usu\xe1rios"}),(0,m.jsxs)("button",{className:"btn btn-success btn-sm float-right","data-toggle":"modal","data-target":"#novo",children:["Novo ",(0,m.jsx)("i",{className:"fas fa-plus"})]})]}),(0,m.jsx)("div",{className:"col-md-12",children:(0,m.jsxs)("div",{className:"card mt-3",children:[(0,m.jsx)("div",{className:"card-title mb-3",children:(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-md-4",children:(0,m.jsxs)("div",{className:"input-group mb-3",children:[(0,m.jsx)("div",{className:"input-group-prepend",children:(0,m.jsx)("span",{className:"input-group-text",children:(0,m.jsx)("i",{className:"fas fa-search"})})}),(0,m.jsx)("input",{type:"text",className:"form-control",placeholder:"Pesquisar"})]})})})}),(0,m.jsx)("div",{className:"card-body table-responsive p-0",children:(0,m.jsxs)("table",{className:"table table-hover text-nowrap",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Nome"}),(0,m.jsx)("th",{children:"Cargo"})]})}),(0,m.jsx)("tbody",{children:s?s.map((function(e){return"Admin"!=e.cargo?(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:e.nome}),(0,m.jsx)("td",{children:e.cargo}),(0,m.jsxs)("td",{children:[" ",(0,m.jsx)("button",{type:"button",className:"close","aria-label":"Close","data-toggle":"modal","data-target":"#eliminar",onClick:function(){x(e)},children:(0,m.jsxs)("span",{"aria-hidden":"true",children:[" ",(0,m.jsx)("i",{className:"fas fa-trash text-danger"})," "]})})]})]}):""})):(0,m.jsx)("div",{className:"overlay mb-5 mt-5 text-center",children:(0,m.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})})]})}),(0,m.jsx)("div",{className:"card-footer clearfix",children:(0,m.jsxs)("ul",{className:"pagination pagination-sm m-0 float-right",children:[(0,m.jsx)("li",{className:"page-item  ".concat(1==j?"disabled":""),children:(0,m.jsx)("a",{href:"#",className:"page-link",onClick:function(){!function(){if(1==j)return!1;N(Number(j)-1)}()},children:"Anterior"})}),g&&g.map((function(e){return(0,m.jsx)("li",{className:"page-item  ".concat(j==e.page?"active":""),children:(0,m.jsx)("a",{className:"page-link",onClick:function(){N(e.page)},href:"#",children:e.page})})})),(0,m.jsx)("li",{className:"page-item  ".concat(j==C?"disabled":""),children:(0,m.jsx)("a",{href:"#",className:"page-link",onClick:function(){!function(){if(j==g)return!1;N(Number(j)+1)}()},children:"Proximo"})})]})})]})})]}),(0,m.jsx)("div",{className:"modal fade",id:"eliminar",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true",children:(0,m.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:(0,m.jsxs)("div",{className:"modal-content",children:[(0,m.jsxs)("div",{className:"modal-header",children:[(0,m.jsx)("h5",{className:"modal-title",children:(0,m.jsx)("i",{className:"fas fa-trash text-danger fa-2x"})}),(0,m.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,m.jsx)("div",{className:"modal-body",children:(0,m.jsx)("h3",{children:(0,m.jsxs)("p",{children:[" Eliminar ",p&&p.nome," ?"]})})}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"Cancela"}),S?(0,m.jsx)("button",{type:"button",className:"btn btn-danger",children:(0,m.jsx)("div",{className:"spinner-border",role:"status",children:(0,m.jsx)("span",{className:"sr-only",children:"Aguarde..."})})}):(0,m.jsx)("button",{type:"button",className:"btn btn-warning",onClick:function(){D()},children:"Elimina"})]})]})})}),(0,m.jsx)("div",{className:"modal fade",id:"novo",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,m.jsx)("div",{className:"modal-dialog modal-dialog-centered ",children:(0,m.jsxs)("div",{className:"modal-content",children:[(0,m.jsxs)("div",{className:"modal-header",children:[(0,m.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Criar Novo Usu\xe1rio"}),(0,m.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,m.jsx)("div",{className:"modal-body",children:(0,m.jsxs)("form",{children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{for:"nome",children:"Nome"}),(0,m.jsx)("input",{type:"email",className:"form-control",id:"nome",onChange:function(e){_(e.target.value)},placeholder:"Email do novo usu\xe1rio"})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{for:"eamil",children:"Email"}),(0,m.jsx)("input",{type:"email",className:"form-control",id:"eamil",onChange:function(e){J(e.target.value)},placeholder:"Email do novo usu\xe1rio"})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{for:"cargo",children:"Cargo"}),(0,m.jsx)("input",{type:"text",className:"form-control",id:"cargo",placeholder:"Cargo",onChange:function(e){P(e.target.value)}})]})]})}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancelar"}),S?(0,m.jsx)("button",{type:"button",className:"btn btn-primary",children:(0,m.jsx)("div",{className:"spinner-border",role:"status",children:(0,m.jsx)("span",{className:"sr-only",children:"Aguarde..."})})}):M&&E&&L?(0,m.jsx)("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:function(){F()},children:"Cadastrar"}):(0,m.jsx)("button",{type:"button",className:"btn btn-primary",disabled:!0,children:"Cadastrar"})]})]})})})]})]})}},750:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gestao-usuarios",function(){return s(5922)}])}},function(e){e.O(0,[324,774,888,179],(function(){return a=750,e(e.s=a);var a}));var a=e.O();_N_E=a}]);
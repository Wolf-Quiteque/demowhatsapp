(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[816],{7965:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return u}});var s=n(29),t=n(7794),r=n.n(t),c=n(9008),l=(n(1664),n(782)),o=(n(4213),n(7294)),i=(n(1163),n(6304)),d=n(5893);function u(){var e,a=(0,o.useState)(),n=a[0],t=a[1],u=(0,o.useState)([]),m=u[0],p=u[1],h=(0,o.useState)(""),f=h[0],x=h[1],b=(0,o.useState)(null),j=b[0],v=b[1],N=(0,o.useState)([]),g=N[0],y=N[1],C=(0,o.useState)(!1),k=C[0],w=C[1],O=(0,o.useState)(""),_=O[0],S=O[1],T=function(){var e=(0,s.Z)(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.QN)("authsesh");case 2:a=e.sent,t(a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,s.Z)(r().mark((function e(a){var n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/assets/allassets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tipo:"recursos",colecao:a})});case 3:return n=e.sent,e.next=6,n.json();case 6:s=e.sent,y(s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(a){return e.apply(this,arguments)}}(),E=function(){var e=(0,s.Z)(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/colecao/allcolecao",{method:"POST",headers:{"Content-Type":"application/json"}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,p(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var a=(0,s.Z)(r().mark((function a(){var n,s,t,c;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=l.Am.loading("aguarde...",{closeOnClick:!0}),w(!0),n=new FormData,s=Date.now()+j.name,n.append("file",j),n.append("name",s),n.append("upload_preset","ipo-uploads"),a.next=9,fetch("https://api.cloudinary.com/v1_1/quitopia/image/upload",{method:"Post",body:n}).then((function(e){return e.json()}));case 9:return t=a.sent,a.next=12,fetch("/api/assets/novo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file:t.secure_url,tipo:"recursos",colecao:f,titulo:j.name})});case 12:c=a.sent,A(f),200==c.status?l.Am.update(e,{render:"ficheiro carregado",type:"success",isLoading:!1,closeOnClick:!0,autoClose:1300}):l.Am.update(e,{render:"Tenta Novamente",type:"error",isLoading:!1,closeOnClick:!0,autoClose:1300}),v(null),$("#upload").modal("hide");case 17:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),P=function(){var a=(0,s.Z)(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=l.Am.loading("aguarde...",{closeOnClick:!0}),w(!0),a.prev=2,a.next=5,fetch("/api/colecao/novo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nome:_})});case 5:return n=a.sent,a.next=8,n.json();case 8:"success"==(s=a.sent).message?(l.Am.update(e,{render:"Criado com successo",type:"success",isLoading:!1,closeOnClick:!0,autoClose:!0}),E()):l.Am.update(e,{render:s.message,type:"error",isLoading:!1,closeOnClick:!0,autoClose:!0}),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),l.Am.update(e,{render:"houve um erro",type:"error",isLoading:!1,closeOnClick:!0,autoClose:!0});case 15:w(!1),$("#novo").modal("hide");case 17:case"end":return a.stop()}}),a,null,[[2,12]])})));return function(){return a.apply(this,arguments)}}();return(0,o.useEffect)((function(){n||T()}),[]),(0,o.useEffect)((function(){f&&A(f)}),[f]),(0,o.useEffect)((function(){E()}),[]),(0,d.jsxs)("div",{className:"",children:[(0,d.jsxs)(c.default,{children:[(0,d.jsx)("title",{children:"ANJE - Recursos"}),(0,d.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,d.jsxs)("main",{children:[(0,d.jsx)(l.Ix,{}),(0,d.jsxs)("div",{className:"row",children:[(0,d.jsxs)("div",{className:"col-md-12",style:{marginTop:"30px",marginBottom:"30px"},children:[(0,d.jsx)("h1",{children:f||"Recursos"}),f&&(0,d.jsx)("a",{className:"backbutton  float-right",onClick:function(){x(""),y(null)},children:(0,d.jsx)("i",{className:"fa fa-arrow-left"})}),(0,d.jsx)(d.Fragment,{children:n&&"administrador"==n.tipo&&(f?(0,d.jsxs)(d.Fragment,{children:[" ",(0,d.jsx)("a",{className:"btn btn-primary","data-toggle":"modal","data-target":"#upload",onClick:function(){},children:"Carregar ficheiros"})]}):(0,d.jsxs)("button",{className:"btn btn-success btn-sm float-right","data-toggle":"modal","data-target":"#novo",children:["Nova Cole\xe7\xe3o ",(0,d.jsx)("i",{className:"fas fa-plus"})]}))})]}),(0,d.jsx)("div",{className:"row",children:f?(0,d.jsx)(d.Fragment,{children:g&&g.map((function(e,a){return(0,d.jsx)("div",{className:"col-xs-4 col-sm-3 col-md-6 col-4",children:(0,d.jsxs)("a",{href:e.file,target:"_blank",className:"folder",children:[(0,d.jsx)("i",{className:"bi bi-file-earmark-pdf placeholders"}),(0,d.jsx)("div",{className:"folder-name",children:e.titulo})]})},a)}))}):m&&m.map((function(e,a){return(0,d.jsx)("div",{className:"col-xs-4 col-sm-3 col-md-6 col-4",children:(0,d.jsxs)("a",{className:"folder",onClick:(0,s.Z)(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,new Promise((function(e){return setTimeout(e,300)}));case 2:x(e.nome);case 3:case"end":return a.stop()}}),a)}))),children:[(0,d.jsx)("i",{className:"fa fa-folder"}),(0,d.jsx)("div",{className:"folder-name",children:e.nome})]})},a)}))})]})]}),(0,d.jsx)("div",{className:"modal fade",id:"novo",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,d.jsx)("div",{className:"modal-dialog modal-dialog-centered ",children:(0,d.jsxs)("div",{className:"modal-content",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Criar Nova Cole\xe7\xe3o"}),(0,d.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:(0,d.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,d.jsx)("div",{className:"modal-body",children:(0,d.jsx)("form",{children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{for:"nome",children:"Nome"}),(0,d.jsx)("input",{type:"text",className:"form-control",id:"nome",onChange:function(e){S(e.target.value)},placeholder:"Cria uma Nova Cole\xe7\xe3o"})]})})}),(0,d.jsxs)("div",{className:"modal-footer",children:[(0,d.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancelar"}),k?(0,d.jsx)("button",{type:"button",className:"btn btn-primary",children:(0,d.jsx)("div",{className:"spinner-border",role:"status",children:(0,d.jsx)("span",{className:"sr-only",children:"Aguarde..."})})}):_?(0,d.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){P()},children:"Cadastrar"}):(0,d.jsx)("button",{type:"button",className:"btn btn-primary",disabled:!0,children:"Cadastrar"})]})]})})}),(0,d.jsx)("div",{className:"modal fade",id:"upload",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,d.jsx)("div",{className:"modal-dialog modal-dialog-centered ",children:(0,d.jsxs)("div",{className:"modal-content",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Carregar ficheiro"}),(0,d.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:(0,d.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,d.jsxs)("div",{className:"modal-body text-center",children:[(0,d.jsxs)("label",{htmlFor:"file",children:[(0,d.jsx)("div",{className:"mb-3",children:(0,d.jsxs)("a",{className:"upload-icon",children:[(0,d.jsx)("i",{style:{fontSize:"60px"},className:"fa fa-upload"}),j&&(0,d.jsx)("div",{children:(0,d.jsx)("span",{class:"badge bg-warning text-white float-right mt-2",children:j.name})})]})}),(0,d.jsx)("input",{type:"file",id:"file",accept:".pdf",onChange:function(e){return v(e.target.files[0])},style:{display:"none"}})]}),(0,d.jsxs)("div",{children:[" ",j&&(k?(0,d.jsxs)(d.Fragment,{children:[" ",(0,d.jsx)("a",{className:"btn btn-sm btn-success disabled mr-2",children:"carregar"}),(0,d.jsx)("a",{className:"btn btn-sm btn-warning disabled",children:"cancelar"})]}):(0,d.jsxs)(d.Fragment,{children:[" ",(0,d.jsx)("a",{className:"btn btn-sm btn-success mr-2",onClick:L,children:"carregar"}),(0,d.jsx)("a",{className:"btn btn-sm btn-warning",onClick:function(){v(null)},children:"cancelar"})]}))]})]}),(0,d.jsx)("div",{className:"modal-footer",children:(0,d.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"Cancelar"})})]})})})]})}},3147:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/recursos",function(){return n(7965)}])}},function(e){e.O(0,[324,774,888,179],(function(){return a=3147,e(e.s=a);var a}));var a=e.O();_N_E=a}]);